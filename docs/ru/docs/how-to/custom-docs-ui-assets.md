# Статические ресурсы пользовательского интерфейса для документации (самостоятельный хостинг)

Документация API использует **Swagger UI** и **ReDoc**, и для каждой из них нужны определенные JavaScript и CSS файлы.

По умолчанию эти файлы обслуживаются с <abbr title="Content Delivery Network: сервис, обычно состоящий из нескольких серверов, который предоставляет статические файлы, такие как JavaScript и CSS. Обычно используется для обслуживания этих файлов с сервера, находящегося ближе к клиенту, улучшая производительность.">CDN</abbr>.

Но можно настроить их по-своему, задать определенный CDN или обслуживать файлы самостоятельно.

## Пользовательский CDN для JavaScript и CSS

Допустим, вы хотите использовать другой <abbr title="Content Delivery Network">CDN</abbr>, например, `https://unpkg.com/`.

Это может быть полезно, если, например, вы живете в стране, где ограничивают некоторые URL-адреса.

### Отключите автоматическую документацию

Первый шаг — отключить автоматическую документацию, так как по умолчанию она использует стандартный CDN.

Чтобы отключить их, установите для их URL-адресов значение `None` при создании приложения `FastAPI`:

{* ../../docs_src/custom_docs_ui/tutorial001.py hl[8] *}

### Включите пользовательскую документацию

Теперь вы можете создать *операции пути* для пользовательской документации.

Вы можете повторно использовать внутренние функции FastAPI для создания HTML-страниц для документации и передать им необходимые аргументы:

* `openapi_url`: URL-адрес, где HTML-страница документации может получить OpenAPI-схему для вашего API. Вы можете использовать здесь атрибут `app.openapi_url`.
* `title`: заголовок вашего API.
* `oauth2_redirect_url`: здесь вы можете использовать `app.swagger_ui_oauth2_redirect_url`, чтобы воспользоваться значением по умолчанию.
* `swagger_js_url`: URL-адрес, по которому HTML для ваших документов Swagger UI может получить **JavaScript** файл. Это пользовательский URL-адрес CDN.
* `swagger_css_url`: URL-адрес, по которому HTML для ваших документов Swagger UI может получить **CSS** файл. Это пользовательский URL-адрес CDN.

И аналогично для ReDoc...

{* ../../docs_src/custom_docs_ui/tutorial001.py hl[2:6,11:19,22:24,27:33] *}

/// tip | Совет

*Операция пути* для `swagger_ui_redirect` — это вспомогательная функция, когда вы используете OAuth2.

Если вы интегрируете свой API с провайдером OAuth2, вы сможете пройти аутентификацию и вернуться к документации API с полученными учетными данными. И взаимодействовать с ней, используя настоящую аутентификацию OAuth2.

Swagger UI справится с этим закулисно для вас, но ему нужен этот вспомогательный "редирект".

///

### Создайте *операцию пути* для тестирования

Теперь, чтобы убедиться, что всё работает, создайте *операцию пути*:

{* ../../docs_src/custom_docs_ui/tutorial001.py hl[36:38] *}

### Проверьте это

Теперь вы должны иметь возможность перейти к вашей документации по адресу <a href="http://127.0.0.1:8000/docs" class="external-link" target="_blank">http://127.0.0.1:8000/docs</a> и перезагрузить страницу. Она будет загружать эти ресурсы с нового CDN.

## Самостоятельный хостинг JavaScript и CSS для документации

Самостоятельный хостинг JavaScript и CSS может быть полезен, если, например, вам нужно, чтобы ваше приложение продолжало работать даже в офлайн-режиме, без открытого доступа к Интернету, или в локальной сети.

Здесь вы увидите, как можно обслуживать эти файлы самостоятельно, в том же приложении FastAPI, и настроить документацию для их использования.

### Структура файлов проекта

Допустим, структура файлов вашего проекта выглядит так:

```
.
├── app
│   ├── __init__.py
│   ├── main.py
```

Теперь создайте каталог для хранения этих статических файлов.

Теперь ваша новая структура файлов может выглядеть так:

```
.
├── app
│   ├── __init__.py
│   ├── main.py
└── static/
```

### Загрузите файлы

Загрузите необходимые статические файлы для документации и разместите их в каталоге `static/`.

Вы можете щелкнуть правой кнопкой мыши по каждой ссылке и выбрать опцию, аналогичную `Сохранить ссылку как...`.

**Swagger UI** использует файлы:

* <a href="https://cdn.jsdelivr.net/npm/swagger-ui-dist@5/swagger-ui-bundle.js" class="external-link" target="_blank">`swagger-ui-bundle.js`</a>
* <a href="https://cdn.jsdelivr.net/npm/swagger-ui-dist@5/swagger-ui.css" class="external-link" target="_blank">`swagger-ui.css`</a>

А **ReDoc** использует файл:

* <a href="https://cdn.jsdelivr.net/npm/redoc@2/bundles/redoc.standalone.js" class="external-link" target="_blank">`redoc.standalone.js`</a>

После этого ваша структура файлов может выглядеть следующим образом:

```
.
├── app
│   ├── __init__.py
│   ├── main.py
└── static
    ├── redoc.standalone.js
    ├── swagger-ui-bundle.js
    └── swagger-ui.css
```

### Обслуживание статических файлов

* Импортируйте `StaticFiles`.
* "Монтируйте" экземпляр `StaticFiles()` на конкретном пути.

{* ../../docs_src/custom_docs_ui/tutorial002.py hl[7,11] *}

### Тестирование статических файлов

Запустите ваше приложение и перейдите на <a href="http://127.0.0.1:8000/static/redoc.standalone.js" class="external-link" target="_blank">http://127.0.0.1:8000/static/redoc.standalone.js</a>.

Вы должны увидеть очень длинный JavaScript файл для **ReDoc**.

Он может начинаться с чего-то вроде:

```JavaScript
/*! Для информации о лицензии смотрите redoc.standalone.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("null")):
...
```

Это подтверждает, что вы можете обслуживать статические файлы из вашего приложения, и что вы разместили статические файлы для документации в правильном месте.

Теперь мы можем настроить приложение для использования этих статических файлов для документации.

### Отключите автоматическую документацию для статических файлов

Также как при использовании пользовательского CDN, первый шаг — отключить автоматическую документацию, так как по умолчанию они используют CDN.

Чтобы отключить их, установите для их URL-адресов значение `None` при создании приложения `FastAPI`:

{* ../../docs_src/custom_docs_ui/tutorial002.py hl[9] *}

### Включите пользовательскую документацию для статических файлов

И аналогично предыдущим шагам с пользовательским CDN, теперь вы можете создать *операции пути* для пользовательской документации.

Опять же, вы можете повторно использовать внутренние функции FastAPI для создания HTML-страниц для документации и передать им необходимые аргументы:

* `openapi_url`: URL-адрес, где HTML-страница документации может получить OpenAPI-схему для вашего API. Вы можете использовать здесь атрибут `app.openapi_url`.
* `title`: заголовок вашего API.
* `oauth2_redirect_url`: здесь вы можете использовать `app.swagger_ui_oauth2_redirect_url`, чтобы воспользоваться значением по умолчанию.
* `swagger_js_url`: URL-адрес, по которому HTML для ваших документов Swagger UI может получить **JavaScript** файл. **Это тот файл, который теперь обслуживает ваше приложение**.
* `swagger_css_url`: URL-адрес, по которому HTML для ваших документов Swagger UI может получить **CSS** файл. **Это тот файл, который теперь обслуживает ваше приложение**.

И аналогично для ReDoc...

{* ../../docs_src/custom_docs_ui/tutorial002.py hl[2:6,14:22,25:27,30:36] *}

/// tip | Совет

*Операция пути* для `swagger_ui_redirect` — это вспомогательная функция, когда вы используете OAuth2.

Если вы интегрируете свой API с провайдером OAuth2, вы сможете пройти аутентификацию и вернуться к документации API с полученными учетными данными. И взаимодействовать с ней, используя настоящую аутентификацию OAuth2.

Swagger UI справится с этим закулисно для вас, но ему нужен этот вспомогательный "редирект".

///

### Создайте *операцию пути* для тестирования статических файлов

Теперь, чтобы убедиться, что всё работает, создайте *операцию пути*:

{* ../../docs_src/custom_docs_ui/tutorial002.py hl[39:41] *}

### Проверьте пользовательский интерфейс статических файлов

Теперь вы должны иметь возможность отключить WiFi, перейти к вашей документации по адресу <a href="http://127.0.0.1:8000/docs" class="external-link" target="_blank">http://127.0.0.1:8000/docs</a> и перезагрузить страницу.

И даже без Интернета вы сможете увидеть документацию для вашего API и взаимодействовать с ней.
