# Расширение OpenAPI

Бывают случаи, когда вам может понадобиться изменить сгенерированную схему OpenAPI.

В этом разделе вы узнаете, как это сделать.

## Обычный процесс

Обычный (по умолчанию) процесс выглядит следующим образом.

Приложение `FastAPI` (экземпляр) имеет метод `.openapi()`, который ожидается вернуть схему OpenAPI.

В рамках создания объекта приложения для `/openapi.json` (или для того, что вы указали в `openapi_url`) регистрируется *операция пути*.

Она просто возвращает JSON ответ с результатом метода `.openapi()` приложения.

По умолчанию метод `.openapi()` проверяет свойство `.openapi_schema`, чтобы увидеть, есть ли в нем содержимое, и возвращает их.

Если его нет, он генерирует его с использованием вспомогательной функции в `fastapi.openapi.utils.get_openapi`.

И эта функция `get_openapi()` принимает в качестве параметров:

* `title`: Заголовок OpenAPI, отображаемый в документации.
* `version`: Версия вашего API, например `2.5.0`.
* `openapi_version`: Версия спецификации OpenAPI, используемой. По умолчанию последняя: `3.1.0`.
* `summary`: Краткое резюме API.
* `description`: Описание вашего API, оно может включать markdown и будет показано в документации.
* `routes`: Список маршрутов, это каждая из зарегистрированных *операций пути*. Они берутся из `app.routes`.

/// info | Информация

Параметр `summary` доступен в OpenAPI 3.1.0 и выше, поддерживается FastAPI 0.99.0 и выше.

///

## Переопределение значений по умолчанию

Используя информацию выше, вы можете использовать ту же вспомогательную функцию для генерации схемы OpenAPI и переопределения каждой части, которая вам нужна.

Например, давайте добавим <a href="https://github.com/Rebilly/ReDoc/blob/master/docs/redoc-vendor-extensions.md#x-logo" class="external-link" target="_blank">OpenAPI расширение ReDoc для включения настраиваемого логотипа</a>.

### Обычный **FastAPI**

Сначала напишите все ваше приложение на **FastAPI** как обычно:

{* ../../docs_src/extending_openapi/tutorial001.py hl[1,4,7:9] *}

### Генерация схемы OpenAPI

Затем используйте ту же вспомогательную функцию для генерации схемы OpenAPI внутри функции `custom_openapi()`:

{* ../../docs_src/extending_openapi/tutorial001.py hl[2,15:21] *}

### Изменение схемы OpenAPI

Теперь вы можете добавить расширение ReDoc, добавив настраиваемый `x-logo` в "объект" `info` в схеме OpenAPI:

{* ../../docs_src/extending_openapi/tutorial001.py hl[22:24] *}

### Кэширование схемы OpenAPI

Вы можете использовать свойство `.openapi_schema` как "кэш", чтобы сохранить вашу сгенерированную схему.

Таким образом, ваше приложение не будет генерировать схему каждый раз, когда пользователь открывает вашу документацию API.

Она будет сгенерирована только один раз, и затем та же самая кэшированная схема будет использована для следующих запросов.

{* ../../docs_src/extending_openapi/tutorial001.py hl[13:14,25:26] *}

### Переопределение метода

Теперь вы можете заменить метод `.openapi()` на вашу новую функцию.

{* ../../docs_src/extending_openapi/tutorial001.py hl[29] *}

### Проверьте это

Как только вы перейдете по адресу <a href="http://127.0.0.1:8000/redoc" class="external-link" target="_blank">http://127.0.0.1:8000/redoc</a>, вы увидите, что вы используете ваш настраиваемый логотип (в этом примере используется логотип **FastAPI**):

<img src="/img/tutorial/extending-openapi/image01.png">
