# Расширение OpenAPI

Есть случаи, когда вам может понадобиться изменить сгенерированную схему OpenAPI.

В этом разделе вы увидите, как это сделать.

## Обычный процесс

Обычный (по умолчанию) процесс таков:

`FastAPI` приложение (экземпляр) имеет метод `.openapi()`, который должен возвращать схему OpenAPI.

В процессе создания объекта приложения регистрируется *операция пути* для `/openapi.json` (или для того, что вы установили в `openapi_url`).

Он просто возвращает JSON-ответ с результатом выполнения метода `.openapi()` приложения.

По умолчанию, метод `.openapi()` проверяет свойство `.openapi_schema`, чтобы увидеть, есть ли в нем содержимое, и возвращает его.

Если его нет, он генерирует его с использованием вспомогательной функции из `fastapi.openapi.utils.get_openapi`.

Эта функция `get_openapi()` принимает в качестве параметров:

* `title`: Заголовок OpenAPI, показываемый в документации.
* `version`: Версия вашего API, например, `2.5.0`.
* `openapi_version`: Версия спецификации OpenAPI, используемая по умолчанию. На данный момент последняя версия: `3.1.0`.
* `summary`: Краткое резюме API.
* `description`: Описание вашего API, которое может включать markdown и будет показано в документации.
* `routes`: Список маршрутов, каждое из них является зарегистрированной *операцией пути*. Они взяты из `app.routes`.

/// info | Информация

Параметр `summary` доступен в OpenAPI 3.1.0 и выше, поддерживается в FastAPI 0.99.0 и выше.

///

## Переопределение стандартных значений

Используя вышеуказанную информацию, вы можете использовать ту же вспомогательную функцию для генерации схемы OpenAPI и переопределить каждую часть, которая вам нужна.

Например, давайте добавим <a href="https://github.com/Rebilly/ReDoc/blob/master/docs/redoc-vendor-extensions.md#x-logo" class="external-link" target="_blank">расширение OpenAPI от ReDoc, чтобы включить нестандартный логотип</a>.

### Обычный **FastAPI**

Сначала напишите все ваше приложение **FastAPI** как обычно:

{* ../../docs_src/extending_openapi/tutorial001.py hl[1,4,7:9] *}

### Генерация схемы OpenAPI

Затем используйте ту же вспомогательную функцию для генерации схемы OpenAPI внутри функции `custom_openapi()`:

{* ../../docs_src/extending_openapi/tutorial001.py hl[2,15:21] *}

### Изменение схемы OpenAPI

Теперь вы можете добавить расширение ReDoc, добавив настраиваемый `x-logo` в "объект" `info` схемы OpenAPI:

{* ../../docs_src/extending_openapi/tutorial001.py hl[22:24] *}

### Кэширование схемы OpenAPI

Вы можете использовать свойство `.openapi_schema` в качестве "кэша" для хранения вашей сгенерированной схемы.

Таким образом, вашему приложению не придется генерировать схему каждый раз, когда пользователь открывает вашу документацию API.

Она будет сгенерирована только один раз, и затем будет использоваться та же закэшированная схема для следующих запросов.

{* ../../docs_src/extending_openapi/tutorial001.py hl[13:14,25:26] *}

### Переопределение метода

Теперь вы можете заменить метод `.openapi()` на вашу новую функцию.

{* ../../docs_src/extending_openapi/tutorial001.py hl[29] *}

### Проверка

Как только вы перейдете на <a href="http://127.0.0.1:8000/redoc" class="external-link" target="_blank">http://127.0.0.1:8000/redoc</a>, вы увидите, что используете свой нестандартный логотип (в этом примере, логотип **FastAPI**):

<img src="/img/tutorial/extending-openapi/image01.png">
