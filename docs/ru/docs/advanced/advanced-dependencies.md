# Продвинутые зависимости

## Параметризованные зависимости

Все зависимости, которые мы видели ранее, это фиксированные функции или классы.

Но могут возникать случаи, когда вам нужно задать параметры зависимости, не объявляя множество разных функций или классов.

Представим, что мы хотим иметь зависимость, которая проверяет, содержит ли параметр запроса `q` определенное фиксированное содержимое.

Но мы хотим иметь возможность параметризовать это фиксированное содержимое.

## Экземпляр "callable"

В Python есть способ сделать экземпляр класса "вызваемым" (callable).

Не сам класс (который уже является вызваемым), а именно экземпляр этого класса.

Для этого мы объявляем метод `__call__`:

{* ../../docs_src/dependencies/tutorial011_an_py39.py hl[12] *}

В этом случае этот `__call__` используется **FastAPI** для проверки дополнительных параметров и подзависимости, и это то, что будет вызвано для передачи значения в параметр в вашей функции *операции пути* позже.

## Параметризация экземпляра

Теперь мы можем использовать `__init__` для объявления параметров экземпляра, которые мы можем использовать для "параметризации" зависимости:

{* ../../docs_src/dependencies/tutorial011_an_py39.py hl[9] *}

В этом случае **FastAPI** никогда не дотронется до или не будет интересоваться `__init__`, мы будем использовать его напрямую в нашем коде.

## Создание экземпляра

Мы можем создать экземпляр этого класса с помощью:

{* ../../docs_src/dependencies/tutorial011_an_py39.py hl[18] *}

Таким образом, мы можем "параметризовать" нашу зависимость, которая теперь содержит `"bar"`, как атрибут `checker.fixed_content`.

## Использование экземпляра в качестве зависимости

Затем мы можем использовать этот `checker` в `Depends(checker)`, вместо `Depends(FixedContentQueryChecker)`, потому что зависимость — это экземпляр `checker`, а не сам класс.

И при разрешении зависимости **FastAPI** вызовет этот `checker` следующим образом:

```Python
checker(q="somequery")
```

...и передаст то, что это возвращает, как значение зависимости в нашей функции *операции пути* как параметр `fixed_content_included`:

{* ../../docs_src/dependencies/tutorial011_an_py39.py hl[22] *}

/// tip | Совет

Все это может показаться надуманным. И может быть не совсем ясно, насколько это полезно.

Эти примеры намеренно просты, но показывают, как все работает.

В разделах о безопасности есть вспомогательные функции, которые реализованы точно таким же образом.

Если вы поняли все это, вы уже знаете, как эти инструменты безопасности работают под капотом.

///
